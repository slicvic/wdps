!function(r,a,i,s){new r({el:".js-app",data:{searching:!1,showResults:!1,validationErrors:[],maxPhrases:3,minPhrases:2,phrases:["",""],examples:["Jordan GOAT","LeBron GOAT","Kobe GOAT"],chart:null,chartColors:["#5d5d5a","#ffcdab","#d2c8c8"],results:{}},computed:{showAddPhraseBtn:function(){return this.phrases.length<this.maxPhrases},showRemovePhraseBtn:function(){return this.phrases.length>this.minPhrases}},mounted:function(){a(this.$el).removeClass("d-none"),a(this.$el).on("keypress",".js-phrase-input",function(s){13===s.which&&this.search()}.bind(this)),2<=s.length&&s.length<=3&&(this.phrases=s,this.search())},methods:{addPhrase:function(){this.phrases.length<this.maxPhrases&&this.phrases.push("")},removePhrase:function(s){this.phrases.splice(s,1)},hideResults:function(){this.showResults=!1},handlePhraseInputKeyup:function(s){this.validatePhrases(s)},validatePhrases:function(s){for(var e=!0,t=0;t<this.phrases.length;t++)if(void 0===s||s==t){var h=this.phrases[t].trim().replace(/\s\s+/g," ");""==h?(e=!1,r.set(this.validationErrors,t,"Phrase cannot be blank!")):h.split(" ").length<2?(e=!1,r.set(this.validationErrors,t,"Phrase must be 2 or more words!")):r.set(this.validationErrors,t,"")}return e},search:function(){if(this.validatePhrases()){this.showResults=!1,this.searching=!0;var r=this,e=[];this.phrases.forEach(function(s){e.push("q[]="+s)}),a.getJSON("/api/search.php",e.join("&")).done(function(s){if("object"!=typeof s.results)return r.results=!1,r.searching=!1,void(r.showResults=!0);r.results=s.results;var e=[],t=[];r.results.forEach(function(s){t.push(s.phrase),e.push(s.percent)});var h=a(r.$refs.chart_canvas)[0];h.getContext("2d").clearRect(0,0,h.width,h.height),r.chart&&r.chart.destroy(),r.searching=!1,r.showResults=!0,setTimeout(function(){r.chart=new i(h,{type:"pie",options:{legend:{display:!1}},data:{labels:t,datasets:[{data:e,backgroundColor:r.chartColors}]}})},100)}).fail(function(){r.results=!1,r.showResults=!0,r.searching=!1})}}}})}(window.Vue,window.jQuery,window.Chart,window.q);