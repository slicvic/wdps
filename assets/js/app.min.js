new Vue({el:"#app",data:{searching:!1,showResults:!1,showErrors:!1,maxPhrases:5,minPhrases:2,phrases:["",""],results:{total:0,totalFormatted:0,phrases:[]}},mounted:function(){$(this.$el).removeClass("d-none")},methods:{addPhrase:function(){this.phrases.length<this.maxPhrases&&this.phrases.push("")},removePhrase:function(s){this.phrases.splice(s,1)},validateForm:function(){return!this.phrases.some(function(s){return 0===s.trim().length})},search:function(){if(this.showErrors=!1,this.validateForm()){this.showResults=!1,this.searching=!0;var s=this,e=[];this.phrases.forEach(function(s){e.push("phrases[]="+s)});var t=$(this.$refs.chart_canvas)[0],a=t.getContext("2d");a.clearRect(0,0,t.width,t.height),$.getJSON("/search.php",e.join("&")).done(function(e){s.results=e,s.searching=!1,e.total<1||(s.showResults=!0,setTimeout(function(){var e=[],a=[];s.results.phrases.forEach(function(s){a.push(s.text),e.push(s.percent)}),new Chart(t,{type:"pie",data:{labels:a,datasets:[{backgroundColor:["#3e95cd","#8e5ea2"],data:e}]}})},100))}).fail(function(){s.searching=!1})}else this.showErrors=!0}}});