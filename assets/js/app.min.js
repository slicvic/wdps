(function(s,e,t){new s({el:".js-app",data:{searching:!1,showResults:!1,validationErrors:[],maxPhrases:3,minPhrases:2,phrases:["",""],placeholders:["Enter a phrase","Enter a phrase","Enter a phrase"],chart:null,chartColors:["#ff9ff3","#feca57","#1dd1a1"],results:{}},computed:{showAddPhraseBtn:function(){return this.phrases.length<this.maxPhrases},showRemovePhraseBtn:function(){return this.phrases.length>this.minPhrases}},mounted:function(){e(this.$el).removeClass("d-none"),e(this.$el).on("keypress",".js-phrase-input",function(s){13===s.which&&this.search()}.bind(this))},methods:{addPhrase:function(){this.phrases.length<this.maxPhrases&&this.phrases.push("")},removePhrase:function(s){this.phrases.splice(s,1)},hideResults:function(){this.showResults=!1},handlePhraseInputKeyup:function(s){this.validatePhrases(s)},validatePhrases:function(e){for(var t=!0,r=0;r<this.phrases.length;r++)if(void 0===e||e==r){var h=this.phrases[r].trim().replace(/\s\s+/g," ");""==h?(t=!1,s.set(this.validationErrors,r,"Phrase cannot be blank!")):h.split(" ").length<2?(t=!1,s.set(this.validationErrors,r,"Phrase must be 2 or more words!")):s.set(this.validationErrors,r,"")}return t},search:function(){if(this.validatePhrases()){this.showResults=!1,this.searching=!0;var s=this,r=[];this.phrases.forEach(function(s){r.push("phrases[]="+s)}),e.getJSON("/search.php",r.join("&")).done(function(r){if(r.no_results)return s.results=!1,s.searching=!1,void(s.showResults=!0);s.results=r;var h=[],a=[];s.results.phrases.forEach(function(s){a.push(s.text),h.push(s.percent)});var n=e(s.$refs.chart_canvas)[0];n.getContext("2d").clearRect(0,0,n.width,n.height),s.chart&&s.chart.destroy(),s.searching=!1,s.showResults=!0,setTimeout(function(){s.chart=new t(n,{type:"doughnut",data:{labels:a,datasets:[{data:h,backgroundColor:s.chartColors}]}})},100)}).fail(function(){s.results=!1,s.showResults=!0,s.searching=!1})}}}})})(window.Vue,window.jQuery,window.Chart);