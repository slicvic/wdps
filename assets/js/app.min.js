(function(s,e,t){new s({el:".js-app",data:{searching:!1,showResults:!1,validationErrors:[],maxPhrases:3,minPhrases:2,phrases:["",""],placeholders:["e.g. jordan goat","e.g. lebron goat","e.g. kobe goat"],chart:null,chartColors:["#ff9ff3","#feca57","#1dd1a1"],results:{}},computed:{showAddPhraseBtn:function(){return this.phrases.length<this.maxPhrases},showRemovePhraseBtn:function(){return this.phrases.length>this.minPhrases}},mounted:function(){e(this.$el).removeClass("d-none"),e(this.$el).on("keypress",".js-phrase-input",function(s){13===s.which&&this.search()}.bind(this))},methods:{addPhrase:function(){this.phrases.length<this.maxPhrases&&this.phrases.push("")},removePhrase:function(s){this.phrases.splice(s,1)},hideResults:function(){this.showResults=!1},handlePhraseInputKeyup:function(s){this.validatePhrases(s)},validatePhrases:function(e){for(var t=!0,h=0;h<this.phrases.length;h++)if(void 0===e||e==h){var r=this.phrases[h].trim().replace(/\s\s+/g," ");""==r?(t=!1,s.set(this.validationErrors,h,"Phrase cannot be blank!")):r.split(" ").length<2?(t=!1,s.set(this.validationErrors,h,"Phrase must be 2 or more words!")):s.set(this.validationErrors,h,"")}return t},search:function(){if(this.validatePhrases()){this.showResults=!1,this.searching=!0;var s=this,h=[];this.phrases.forEach(function(s){h.push("phrases[]="+s)}),e.getJSON("/search.php",h.join("&")).done(function(h){if(h.no_results)return s.results=!1,s.searching=!1,void(s.showResults=!0);s.results=h;var r=[],a=[];s.results.phrases.forEach(function(s){a.push(s.text),r.push(s.percent)});var n=e(s.$refs.chart_canvas)[0];n.getContext("2d").clearRect(0,0,n.width,n.height),s.chart&&s.chart.destroy(),s.searching=!1,s.showResults=!0,setTimeout(function(){s.chart=new t(n,{type:"doughnut",data:{labels:a,datasets:[{data:r,backgroundColor:s.chartColors}]}})},100)}).fail(function(){s.results=!1,s.showResults=!0,s.searching=!1})}}}})})(window.Vue,window.jQuery,window.Chart);