!function(a,h,n){new a({el:".js-app",data:{searching:!1,showResults:!1,validationErrors:[],maxPhrases:3,minPhrases:2,phrases:["",""],placeholders:["e.g. jordan goat","e.g. lebron goat","e.g. kobe goat"],chart:null,chartColors:["#5d5d5a","#ffcdab","#d2c8c8"],results:{}},computed:{showAddPhraseBtn:function(){return this.phrases.length<this.maxPhrases},showRemovePhraseBtn:function(){return this.phrases.length>this.minPhrases}},mounted:function(){h(this.$el).removeClass("d-none"),h(this.$el).on("keypress",".js-phrase-input",function(s){13===s.which&&this.search()}.bind(this))},methods:{addPhrase:function(){this.phrases.length<this.maxPhrases&&this.phrases.push("")},removePhrase:function(s){this.phrases.splice(s,1)},hideResults:function(){this.showResults=!1},handlePhraseInputKeyup:function(s){this.validatePhrases(s)},validatePhrases:function(s){for(var e=!0,t=0;t<this.phrases.length;t++)if(void 0===s||s==t){var r=this.phrases[t].trim().replace(/\s\s+/g," ");""==r?(e=!1,a.set(this.validationErrors,t,"Phrase cannot be blank!")):r.split(" ").length<2?(e=!1,a.set(this.validationErrors,t,"Phrase must be 2 or more words!")):a.set(this.validationErrors,t,"")}return e},search:function(){if(this.validatePhrases()){this.showResults=!1,this.searching=!0;var a=this,e=[];this.phrases.forEach(function(s){e.push("phrases[]="+s)}),h.getJSON("/search.php",e.join("&")).done(function(s){if(s.no_results)return a.results=!1,a.searching=!1,void(a.showResults=!0);a.results=s;var e=[],t=[];a.results.phrases.forEach(function(s){t.push(s.text),e.push(s.percent)});var r=h(a.$refs.chart_canvas)[0];r.getContext("2d").clearRect(0,0,r.width,r.height),a.chart&&a.chart.destroy(),a.searching=!1,a.showResults=!0,setTimeout(function(){a.chart=new n(r,{type:"pie",options:{legend:{display:!1}},data:{labels:t,datasets:[{data:e,backgroundColor:a.chartColors}]}})},100)}).fail(function(){a.results=!1,a.showResults=!0,a.searching=!1})}}}})}(window.Vue,window.jQuery,window.Chart);